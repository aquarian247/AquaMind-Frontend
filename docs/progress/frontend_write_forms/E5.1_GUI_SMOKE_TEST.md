# Phase 5 Task E5.1 GUI Smoke Test

**Date**: 2025-10-11  
**Branch**: `feature/frontend-cru-forms`  
**Entities**: Environmental Parameter, Photoperiod Data  
**Estimated Time**: 10-15 minutes

---

## üéØ Prerequisites

1. **Backend running**: `cd /Users/aquarian247/Projects/AquaMind && python manage.py runserver`
2. **Frontend running**: `cd /Users/aquarian247/Projects/AquaMind-Frontend && npm run dev`
3. **Test credentials**: admin / admin123
4. **Browser**: Any modern browser

---

## üß™ Test 1: Environmental Parameter CRUD

### 1.1 Access Management Page
1. Navigate to `/environmental/manage` (or wherever you wire it in routes)
2. **Expected**: Environmental Management page loads
3. **Verify**: 
   - Header shows "Environmental Management"
   - 2 entity cards visible (Environmental Parameter, Photoperiod Data)
   - Each card shows count (may be 0)
   - "Create" buttons visible on each card

### 1.2 Create Environmental Parameter - Simple
1. Click "Create Environmental Parameter" button
2. **Expected**: Modal dialog opens
3. **Verify**: Dialog has title "Create Environmental Parameter"
4. Fill in form:
   - Name: `Dissolved Oxygen`
   - Unit: `mg/L`
   - Description: `Critical water quality parameter for fish respiration`
   - Min Value: `5.0`
   - Max Value: `15.0`
   - Optimal Min: `7.0`
   - Optimal Max: `12.0`
5. Click "Create Parameter"
6. **Expected**:
   - Success toast appears
   - Dialog closes
   - Parameter card count increases by 1

### 1.3 Create Environmental Parameter - Minimal (No Optional Fields)
1. Click "Create Environmental Parameter" again
2. Fill in form:
   - Name: `Water Temperature`
   - Unit: `¬∞C`
   - Description: *(leave empty)*
   - All range fields: *(leave empty)*
3. Click "Create Parameter"
4. **Expected**:
   - Success toast appears
   - Dialog closes
   - Parameter card count increases by 1

### 1.4 Validation - Empty Required Fields
1. Click "Create Environmental Parameter"
2. Click "Create Parameter" without filling anything
3. **Expected**:
   - Form validation errors appear
   - "Name is required" error shown
   - "Unit is required" error shown
   - Form does NOT submit

### 1.5 Edit Environmental Parameter (If Edit Button Exists)
*Note: Edit functionality requires table/list view - skip if not implemented yet*

### 1.6 Delete Environmental Parameter
*Note: Requires table/list view with delete buttons - will be tested when list views are added*

---

## üß™ Test 2: Photoperiod Data CRUD

### 2.1 Create Photoperiod Data - Complete
1. Click "Create Photoperiod Data" button
2. **Expected**: Modal dialog opens
3. **Verify**: Dialog has title "Create Photoperiod Data"
4. Fill in form:
   - Area: *Select any area from dropdown*
   - Date: `2025-10-11` (today's date)
   - Day Length (hours): `16.5`
   - Light Intensity: `500.0`
   - Interpolated Data: *Check the checkbox*
5. Click "Create Photoperiod Data"
6. **Expected**:
   - Success toast appears
   - Dialog closes
   - Photoperiod Data card count increases by 1

### 2.2 Create Photoperiod Data - Minimal (No Optional Fields)
1. Click "Create Photoperiod Data" again
2. Fill in form:
   - Area: *Select different area*
   - Date: `2025-10-10`
   - Day Length (hours): `14.0`
   - Light Intensity: *(leave empty)*
   - Interpolated Data: *(leave unchecked)*
3. Click "Create Photoperiod Data"
4. **Expected**:
   - Success toast appears
   - Dialog closes
   - Photoperiod Data card count increases by 1

### 2.3 Validation - Day Length Range
1. Click "Create Photoperiod Data"
2. Fill in form:
   - Area: *Select any area*
   - Date: `2025-10-12`
   - Day Length (hours): `25.0` (invalid - exceeds 24)
3. Click "Create Photoperiod Data"
4. **Expected**:
   - Validation error appears
   - "Day length must be at most 24" error shown
   - Form does NOT submit

### 2.4 Validation - Empty Required Fields
1. Clear the form or open new dialog
2. Click "Create Photoperiod Data" without filling anything
3. **Expected**:
   - Form validation errors appear
   - "Area is required" error shown
   - "Date is required" error shown (if applicable)
   - "Day length is required" error shown
   - Form does NOT submit

---

## üß™ Test 3: Permission Gates (If Implemented)

### 3.1 Test as Non-Write User
1. Log out and log in as a user with read-only permissions
2. Navigate to Environmental Management page
3. **Expected**:
   - Page loads
   - "Create" buttons are HIDDEN or DISABLED
   - Cannot access create forms

### 3.2 Test as Write User
1. Log in as user with write permissions (admin)
2. **Expected**:
   - All "Create" buttons visible and enabled
   - Can create entities successfully

---

## üß™ Test 4: Auto-Refresh / Cache Invalidation

### 4.1 Create and Verify Count
1. Note the current count on Environmental Parameter card
2. Create new Environmental Parameter
3. **Expected**:
   - Count on card updates immediately (auto-refresh)
   - No page reload needed

### 4.2 Multiple Creates
1. Create 3 Environmental Parameters in succession
2. **Expected**:
   - Each creation increases count by 1
   - No stale data shown

---

## üß™ Test 5: Cross-Browser & Theme Testing

### 5.1 Theme Toggle (If Implemented)
1. Toggle between light/dark themes
2. **Expected**:
   - Forms render correctly in both themes
   - All text is readable
   - No color contrast issues

### 5.2 Responsive Layout
1. Resize browser window to mobile size
2. **Expected**:
   - Forms remain usable
   - All fields accessible
   - Buttons don't overflow

---

## üß™ Test 6: Backend Audit Trail Verification

### 6.1 Verify History Tracking (Backend Django Admin)
1. Navigate to Django admin: `http://localhost:8000/admin/`
2. Go to "Historical environmental parameters"
3. **Expected**:
   - Historical records exist for created parameters
   - Each record shows "created via API by [username]"

### 6.2 Delete with Audit Reason (When Implemented)
*Note: Requires delete button in list view*
1. Attempt to delete an Environmental Parameter
2. **Expected**:
   - Audit reason dialog appears
   - Requires min 10 character reason
   - Cannot skip reason entry

---

## ‚úÖ Success Criteria

All tests should pass with:
- ‚úÖ No console errors
- ‚úÖ No type errors (checked during dev)
- ‚úÖ All validations working correctly
- ‚úÖ Auto-refresh working (counts update)
- ‚úÖ Permission gates respected (if implemented)
- ‚úÖ Success toasts appear on successful operations
- ‚úÖ Forms close after successful submission
- ‚úÖ Backend audit trails captured (verify in Django admin)

---

## üêõ Common Issues & Solutions

### Issue: "404 Not Found" when accessing /environmental/manage
**Solution**: Route not wired yet. Add route in `client/src/router/index.tsx`:
```typescript
<Route path="/environmental/manage" component={EnvironmentalManagementPage} />
```

### Issue: Area dropdown empty in Photoperiod form
**Solution**: 
1. Check backend has areas: `http://localhost:8000/api/v1/infrastructure/areas/`
2. Create areas if none exist (via infrastructure management)

### Issue: Forms don't close after submission
**Solution**: Check browser console for errors. Likely an API issue.

### Issue: Count doesn't update after creation
**Solution**: Check query invalidation keys in `api.ts`. Should match query keys.

---

## üìä Test Results Template

```
Date: 2025-10-11
Tester: [Your Name]
Browser: [Chrome/Firefox/Safari] [Version]

Test 1: Environmental Parameter CRUD
  1.1 Access Management Page: PASS / FAIL
  1.2 Create - Simple: PASS / FAIL
  1.3 Create - Minimal: PASS / FAIL
  1.4 Validation: PASS / FAIL

Test 2: Photoperiod Data CRUD
  2.1 Create - Complete: PASS / FAIL
  2.2 Create - Minimal: PASS / FAIL
  2.3 Validation - Day Length: PASS / FAIL
  2.4 Validation - Required: PASS / FAIL

Test 3: Permission Gates
  3.1 Non-Write User: PASS / FAIL / SKIP
  3.2 Write User: PASS / FAIL

Test 4: Auto-Refresh
  4.1 Create and Verify Count: PASS / FAIL
  4.2 Multiple Creates: PASS / FAIL

Test 5: Cross-Browser
  5.1 Theme Toggle: PASS / FAIL / SKIP
  5.2 Responsive Layout: PASS / FAIL

Test 6: Backend Audit
  6.1 History Tracking: PASS / FAIL
  6.2 Delete with Audit: PASS / FAIL / SKIP

Overall Status: PASS / FAIL
Issues Found: [List any issues]
```

---

## üéØ Next Steps After Testing

1. **If all tests pass**: Phase 5 Task E5.1 ready for UAT handoff
2. **If issues found**: Document in GitHub issues, fix, re-test
3. **E5.2 Decision**: Decide if WeatherData/StageTransitionEnvironmental need CRUD forms
4. **UAT Preparation**: Hand off to QA team with this smoke test as guide

---

**Happy Testing! üéâ**

